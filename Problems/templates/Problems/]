{% extends 'Problems/base.html' %}
{% comment %}
    Context has PollQuestion element question
    Context has list of PollChoice elements choices
{% endcomment %}

{% block content %}
<form method="POST" action="{% if choices %}{% url 'edit_pollquestion' questionpk=question.pk%}{% else %}{% url 'new_question' pollpk=question.poll.pk questionpk=question.pk %}{% endif %}"> {% csrf_token %}
        <table class="form-table">
            <tbody>
                <tr>
                    <td>Question:</td>
                    <td> <textarea cols="80" rows="10" id="id_text" name="question">{{question.text}}</textarea></td>
                </tr>
                {% for choice in choices %}
                <tr>
                    <td> Choice: </td>
                    <td> <input id="old_{{choice.pk}}" name="old_{{choice.pk}}" type="text" maxlength="200" value="{{choice.text}}"></td>
                </tr>
                {% empty %}
                <tr> 
                    <td> Choice: </td>
                    <td> <input id="id_choice_0" name="new_0" type="text" maxlength="200"></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <button type="button" id="add-choice">Add Choice</button> <input type="submit" value="Submit" >
        <input type="hidden" name="num-choice" value="1" id="num-choice">
    </form>
{% endblock %}

{% block sidenote %}
    <p> To delete a choice, simply leave the input blank. </p>
{% endblock %}

{% block script %}
    <script>
        var numChoices = {{question.pollchoice_set.count}} + 1;
        $("#add-choice").click( function () {
            appendString = '<tr><td>Choice:</td><td><input id="id_choice_'+numChoices.toString()+'" name="new_'+numChoices.toString()+'" type="text" maxlength="200"></tr>';
            $("tbody").append(appendString);
            numChoices++;
            $("#num-choice").val(numChoices.toString());
        });
    </script>
{% endblock %}

